{% extends 'bootstrap-base.html' %}

{% block title %}manage - {{table}}{% endblock %}

{% block content %}

<div class="container" id="vm">
    <div class="row" style="margin-top: 20px">
        <div class="panel panel-default">
            <ul class="nav nav-tabs">
                <li :class="{active: '{{table}}'===$key}" v-for="model of models"><a :href="'' + $key" v-text="$key"></a></li>
            </ul>
            <table class="table table-striped table-hover table-responsive">
                <thead>
                    <tr>
                        <th v-for="title of fields" v-text="title"></th>
                        <th class="col-sm-2">创建时间</th>
                        <th class="col-sm-1" v-show="'{{table}}'!=='users' && {{__user__.admin}}">操作</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="item in items | limitBy 10" track-by="id">
                        <td v-for="field of fields">
                        <a  v-if="'{{table}}'==='blogs' && $key==='name'" :href="'/blog/'+item.id" v-text="item[$key]"></a>
                        <span v-else v-text="item[$key]"></span>
                        </td>
                        <td v-text="item.created_at.toDateTime()"></td>
                        <td v-show="'{{table}}' !== 'users' && {{__user__.admin}}">
                            <a v-show="'{{table}}' === 'blogs'" :href="'blogs/edit?id='+item.id"><span class="glyphicon glyphicon-edit"></span></a>
                            <a href="#" v-on:click="delete_item(item)"><span class="glyphicon glyphicon-trash"></span></a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <ul class="pagination">
            <li v-for="n in page.page_count" :class="{active: page.page_index===(n+1)}">
                <a href="#" v-on:click="gotoPage(n+1)" v-text="n+1"></a>
            </li>
        </ul>
    </div>
</div>
{% endblock %}

{% block script %}
<script src="/static/js/awesome.js"></script>
<script src="/static/js/vue.min.v1.js"></script>
<script src="/static/js/manage.js"></script>
{% endblock %}